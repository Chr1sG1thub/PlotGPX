<!DOCTYPE html>
<html>
<head>
  <title>Leaflet GPX Example</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.5.0/gpx.min.js"></script>
</head>
<body>
  <div id="map" style="height: 500px;"></div>

  <script>
const locations = [
  { name: "Alenya", lat: 42.63980194	, lon: 2.973538916 },
  { name: "ThÃ©za", lat: 42.6383408	, lon: 2.9512366 },
  { name: "Saint-Cyprien", lat: 42.6403122	, lon: 3.032468531 }
];
    // Create the Leaflet map
    var map = L.map('map').setView([45.0, 0], 5);

    // Add a base tile layer (OpenStreetMap)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 18
    }).addTo(map);

    // Load and add the GPX track (replace 'path/to/your.gpx' with your GPX file URL)
    new L.GPX('Thuir - Canohes - Villeneuve-de-la-Raho - Theza - Alenya - St-Cyprien (AR).gpx', {
      async: true,
      marker_options: {
        startIconUrl: 'https://leafletjs.com/examples/custom-icons/leaf-green.png',
        endIconUrl: 'https://leafletjs.com/examples/custom-icons/leaf-red.png',
        shadowUrl: 'https://leafletjs.com/examples/custom-icons/leaf-shadow.png'
      }
    }).on('loaded', function(e) {
      const gpxLayer = e.target; // Leaflet polyline layer of the GPX track
 map.fitBounds(e.target.getBounds());
  const decorator = L.polylineDecorator(gpxLayer, {
    patterns: [
      {
        offset: '5%',
        repeat: '10%',
        symbol: L.Symbol.arrowHead({
          pixelSize: 10,
          polygon: false,
          pathOptions: { stroke: true, color: 'red', weight: 2 }
        })
      }
    ]
  }).addTo(map);
   }).addTo(map);

    // Add markers for each location
locations.forEach(loc => {
 const myIcon = L.divIcon({
    className: 'custom-div-icon',
    html: `<span style="color: blue;background-color: white; opacity: 0.5"><strong>${loc.name}</strong></span>`,
    iconSize: [10, 24],
    iconAnchor: [5, -5]
  });

  L.marker([loc.lat, loc.lon], { icon: myIcon }).addTo(map);
});
    
  </script>
</body>
</html>
